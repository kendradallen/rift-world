var multi = function () { var e = function (e, t, a) { var n = e.options[t.target.getAttribute("multi-index")]; if (!n.disabled) { n.selected = !n.selected; var i, d, l, r = a.limit; if (r > -1) { for (var s = 0, c = 0; c < e.options.length; c++)e.options[c].selected && s++; if (s === r) { this.disabled_limit = !0, "function" == typeof a.limit_reached && a.limit_reached(); for (c = 0; c < e.options.length; c++) { (o = e.options[c]).selected || o.setAttribute("disabled", !0) } } else if (this.disabled_limit) { for (c = 0; c < e.options.length; c++) { var o; "false" === (o = e.options[c]).getAttribute("data-origin-disabled") && o.removeAttribute("disabled") } this.disabled_limit = !1 } } i = "change", d = e, (l = document.createEvent("HTMLEvents")).initEvent(i, !1, !0), d.dispatchEvent(l) } }, t = function (e, t) { if (e.wrapper.selected.innerHTML = "", e.wrapper.non_selected.innerHTML = "", t.non_selected_header && t.selected_header) { var a = document.createElement("div"), n = document.createElement("div"); a.className = "header", n.className = "header", a.innerText = t.non_selected_header, n.innerText = t.selected_header, e.wrapper.non_selected.appendChild(a), e.wrapper.selected.appendChild(n) } if (e.wrapper.search) var i = e.wrapper.search.value; for (var d = null, l = null, r = 0; r < e.options.length; r++) { var s = e.options[r], c = s.value, o = s.textContent || s.innerText, p = document.createElement("a"); p.tabIndex = 0, p.className = "item", p.innerText = o, p.setAttribute("role", "button"), p.setAttribute("data-value", c), p.setAttribute("multi-index", r); var u = s.dataset.list; if (s.classList.contains("unpub") && p.setAttribute("data-pub", "unpub"), p.setAttribute("data-list", u), s.disabled && (p.className += " disabled"), s.selected) { p.className += " selected"; var m = p.cloneNode(!0); m.setAttribute("onclick", "on_click(" + c + ",'" + u + "')"), e.wrapper.selected.appendChild(m) } if ("OPTGROUP" == s.parentNode.nodeName && s.parentNode != l) { if (l = s.parentNode, (d = document.createElement("div")).className = "item-group", s.parentNode.label) { var h = document.createElement("span"); h.innerHTML = s.parentNode.label, h.className = "group-label", d.appendChild(h) } e.wrapper.non_selected.appendChild(d) } s.parentNode == e && (d = null, l = null), (!i || i && o.toLowerCase().indexOf(i.toLowerCase()) > -1) && (null != d ? d.appendChild(p) : e.wrapper.non_selected.appendChild(p)) } }; return function (a, n) { if ((n = void 0 !== n ? n : {}).enable_search = void 0 === n.enable_search || n.enable_search, n.search_placeholder = void 0 !== n.search_placeholder ? n.search_placeholder : "Search...", n.non_selected_header = void 0 !== n.non_selected_header ? n.non_selected_header : null, n.selected_header = void 0 !== n.selected_header ? n.selected_header : null, n.limit = void 0 !== n.limit ? parseInt(n.limit) : -1, isNaN(n.limit) && (n.limit = -1), null == a.dataset.multijs && "SELECT" == a.nodeName && a.multiple) { a.style.display = "none", a.setAttribute("data-multijs", !0); var i = document.createElement("div"); if (i.className = "multi-wrapper", n.enable_search) { var d = document.createElement("input"); d.className = "search-input", d.type = "text", d.setAttribute("placeholder", n.search_placeholder), d.addEventListener("input", function () { t(a, n) }), i.appendChild(d), i.search = d } var l = document.createElement("div"); l.className = "non-selected-wrapper"; var r = document.createElement("div"); r.className = "selected-wrapper", l.addEventListener("click", function (t) { if (t.target.getAttribute("multi-index")) { e(a, t, n); var i = t.target.getAttribute("data-list"), d = t.target.getAttribute("data-value"); $('div[data-value="' + d + '"][data-list="' + i + '"]').hide(), $('div[data-value="' + d + '"][data-list="' + i + '"]').toggleClass("yes-man"), CheckValidity() } }), r.addEventListener("click", function (e) { e.target.getAttribute("multi-index") }), i.addEventListener("keypress", function (t) { var i = 32 === t.keyCode || 13 === t.keyCode; t.target.getAttribute("multi-index") && i && (t.preventDefault(), e(a, t, n)) }), i.appendChild(l), i.appendChild(r), i.non_selected = l, i.selected = r, a.wrapper = i, a.parentNode.insertBefore(i, a.nextSibling); for (var s = 0; s < a.options.length; s++) { var c = a.options[s]; c.setAttribute("data-origin-disabled", c.disabled) } t(a, n), a.addEventListener("change", function () { t(a, n) }) } } }(); "undefined" != typeof jQuery && function (e) { e.fn.multi = function (t) { return t = void 0 !== t ? t : {}, this.each(function () { var a = e(this); multi(a.get(0), t) }) } }(jQuery);